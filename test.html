<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title></title>
</head>

<body>

<ul class="test-results"></ul>

<script type="text/javascript" src="./Future.js"></script>

<script type="text/javascript">
	
	var futureCounts = 0,
		
		ul = document.querySelector("ul.test-results"),
	
		smokeTests = {
			
			tests : [],
			
			add : function (tag, test) {				
				if (typeof test == "function") {
					test._tag = tag;
					this.tests.push(test);
				}
			},
			
			run : function () {
				
				var base = document.createElement("li");
				base.className = "test-results-result";
				
				var li;
				
				for (var i = 0; i < this.tests.length; i++) {
					
					li = base.cloneNode(true);
					li.innerHTML = "TEST :&nbsp;&nbsp;" + this.tests[i]._tag;
					try {
						li._errMsg = this.tests[i]();
					} catch(e) {
						li._errMsg = e.toString() + "<br/>&nbsp;&nbsp;&nbsp;&nbsp;" + e.stack;
					}
					if (li._errMsg !== true) {					
						li.className += " error";
						li.style.cssText = "color: red;";
						if (typeof li._errMsg === "string") {
							li.innerHTML += "<br/>" + li._errMsg;
						}						
					}
					
					ul.appendChild(li);
				}
			}
		};	
	
	smokeTests.add("New future", function () {		
		var n = "f" + futureCounts++,
			f = Future.newOne(n);		
		return f && f.constructor.name == "_cls_Future";
	});
	
	smokeTests.add("Double new future", function () {			
		var n = "f" + futureCounts++,
			f0 = Future.newOne(n),
			f1 = Future.newOne(n);		
		return f0 === f1;
	});
	
	smokeTests.add("Future Exist", function () {
		var n = "f" + futureCounts++;
			Future.newOne(n);
		return Future.exist(n);
	});
	
	smokeTests.add("Remove future", function () {
		var n = "f" + futureCounts++,
			f0 = Future.newOne(n),
			f1 = Future.rmOne(n);
		return !Future.exist(n) && f0 === f1;
	});
	
	smokeTests.add("Get future name", function () {
		var i, n = [], f = [];
				
		for (i = 0; i < 3; i++) {
			n[i] = "f" + futureCounts++;
			f[i] = Future.newOne(n[i]);
		}
		
		for (i = 0; i < n.length; i++) {
			if (f[i].getName() !== n[i]) {
				return "The expected future name:" + n[i] + "but the actual future name" + f[i].getName();
			}
		}
		return true;
	});
	
	
	smokeTests.run();
	
</script>

</body>
</html>